<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Microservices Architecture Scene</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script>
      AFRAME.registerComponent('article-content', {
        init: function () {
          this.sections = [
            { title: "Introduction", content: "In modern DevOps, application scaling is critical. Docker and Kubernetes (K8s) address these challenges." },
            { title: "Microservices Architecture", content: "Microservices are loosely coupled, fine-grained services communicating via APIs. They offer modularity and independent deployment." },
            { title: "Role of Docker", content: "Docker enables containerization, providing consistency, portability, and isolation for microservices." },
            { title: "Kubernetes for Orchestration", content: "K8s orchestrates containers, offering features like auto-scaling, load balancing, and self-healing." },
            { title: "Conclusion", content: "Docker and K8s are crucial for scaling microservices, enabling fault tolerance and enhanced scalability." }
          ];
          this.currentSection = 0;
          this.createContent();
          this.createNavButtons();
        },

        createContent: function () {
          const contentEntity = document.createElement('a-entity');
          contentEntity.setAttribute('geometry', 'primitive: plane; width: 4; height: 2');
          contentEntity.setAttribute('material', 'color: #000; opacity: 0.7');
          contentEntity.setAttribute('position', '0 0 0.01');

          this.titleText = document.createElement('a-text');
          this.titleText.setAttribute('color', '#FFF');
          this.titleText.setAttribute('align', 'center');
          this.titleText.setAttribute('position', '0 0.8 0.02');
          this.titleText.setAttribute('scale', '0.8 0.8 0.8');

          this.contentText = document.createElement('a-text');
          this.contentText.setAttribute('color', '#FFF');
          this.contentText.setAttribute('width', 3.8);
          this.contentText.setAttribute('position', '0 0.4 0.02');
          this.contentText.setAttribute('wrap-count', 40);

          contentEntity.appendChild(this.titleText);
          contentEntity.appendChild(this.contentText);
          this.el.appendChild(contentEntity);

          this.updateContent();
        },

        createNavButtons: function () {
          const prevButton = document.createElement('a-entity');
          prevButton.setAttribute('geometry', 'primitive: plane; width: 0.4; height: 0.2');
          prevButton.setAttribute('material', 'color: #4CAF50');
          prevButton.setAttribute('position', '-2 -0.8 0.02');
          prevButton.setAttribute('text', 'value: Prev; align: center; color: white');
          prevButton.addEventListener('click', () => this.navigate(-1));

          const nextButton = document.createElement('a-entity');
          nextButton.setAttribute('geometry', 'primitive: plane; width: 0.4; height: 0.2');
          nextButton.setAttribute('material', 'color: #4CAF50');
          nextButton.setAttribute('position', '2 -0.8 0.02');
          nextButton.setAttribute('text', 'value: Next; align: center; color: white');
          nextButton.addEventListener('click', () => this.navigate(1));

          this.el.appendChild(prevButton);
          this.el.appendChild(nextButton);
        },

        navigate: function (direction) {
          this.currentSection += direction;
          if (this.currentSection < 0) this.currentSection = 0;
          if (this.currentSection >= this.sections.length) this.currentSection = this.sections.length - 1;
          this.updateContent();
        },

        updateContent: function () {
          const section = this.sections[this.currentSection];
          this.titleText.setAttribute('value', section.title);
          this.contentText.setAttribute('value', section.content);
        }
      });

      AFRAME.registerComponent('microservices-visualization', {
        init: function () {
          this.el.sceneEl.addEventListener('sectionchange', (e) => {
            this.updateVisualization(e.detail.section);
          });
        },

        updateVisualization: function (section) {
          // Update visualization based on the current section
          switch (section) {
            case 0: // Introduction
              // Show overview of system
              break;
            case 1: // Microservices Architecture
              // Show detailed microservices layout
              break;
            case 2: // Docker
              // Highlight Docker containers
              break;
            case 3: // Kubernetes
              // Show Kubernetes orchestration
              break;
            case 4: // Conclusion
              // Show final state of system
              break;
          }
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <img id="sky" crossorigin="anonymous" src="https://cdn.glitch.global/5cfc02c2-e08f-4e29-9383-05c3fa57335f/Microservice%20Skybox.png?v=1729023719252">
      </a-assets>

      <!-- Environment -->
      <a-sky src="#sky"></a-sky>
      
      <!-- Article Content -->
      <a-entity position="-3 1.6 -2" rotation="0 30 0" article-content></a-entity>
     
      <!-- Microservices Visualization -->
      <a-entity position="0 2.6 -3" rotation="15 -30 0">
        <!-- Client -->
        <a-box position="0 2.15 0.25" depth="1.2" height="0.4" width="0.6" color="red" rotation="15 -30 15" service-interaction="name: client"></a-box>
        <a-text value="Client" position="0 2.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <!-- API Gateway -->
        <a-box position="0 1.15 0.25" depth="1.2" height="0.4" width="0.6" color="blue" rotation="15 -30 15" service-interaction="name: api-gateway"></a-box>
        <a-text value="API Gateway" position="0 1.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <!-- Services Row -->
        <a-box position="-1.5 0.15 0.25" depth="1.2" height="0.4" width="0.6" color="green" rotation="15 -30 15" service-interaction="name: auth-service"></a-box>
        <a-text value="Auth Service" position="-1.5 0.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-box position="-0.5 0.15 0.25" depth="1.2" height="0.4" width="0.6" color="yellow" rotation="15 -30 15" service-interaction="name: user-service"></a-box>
        <a-text value="User Service" position="-0.5 0.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-box position="0.5 0.15 0.25" depth="1.2" height="0.4" width="0.6" color="purple" rotation="15 -30 15" service-interaction="name: product-service"></a-box>
        <a-text value="Product Service" position="0.5 0.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-box position="1.5 0.15 0.25" depth="1.2" height="0.4" width="0.6" color="orange" rotation="15 -30 15" service-interaction="name: order-service"></a-box>
        <a-text value="Order Service" position="1.5 0.3 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <!-- Payment Services -->
        <a-box position="1 -0.85 0.25" depth="1.2" height="0.4" width="0.6" color="pink" rotation="15 -30 15" service-interaction="name: payment-service"></a-box>
        <a-text value="Payment Service" position="1 -0.7 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-box position="2 -0.85 0.25" depth="1.2" height="0.4" width="0.6" color="cyan" rotation="15 -30 15" service-interaction="name: external-payment"></a-box>
        <a-text value="External Payment" position="2 -0.7 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <!-- Databases -->
        <a-cylinder position="-0.5 -1 0" radius="0.25" height="0.5" color="lightgray" service-interaction="name: user-db"></a-cylinder>
        <a-text value="User DB" position="-0.5 -0.7 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-cylinder position="-1.5 -1 0" radius="0.25" height="0.5" color="lightgray" service-interaction="name: product-db"></a-cylinder>
        <a-text value="Product DB" position="-1.5 -0.7 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
        <a-cylinder position="-2.5 -1 0" radius="0.25" height="0.5" color="lightgray" service-interaction="name: order-db"></a-cylinder>
        <a-text value="Order DB" position="-2.5 -0.7 0.5" align="center" rotation="-15 30 0" scale="0.5 0.5 0.5"></a-text>
      </a-entity>

      <!-- Camera and Cursor -->
      <a-camera position="0 1.6 0">
        <a-cursor></a-cursor>
      </a-camera>
    </a-scene>
  </body>
</html>
