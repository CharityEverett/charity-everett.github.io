<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script>
      AFRAME.registerComponent('multipolar-neuron', {
        init: function() {
          this.createHexagonalSoma();
          this.createDendrites();
          this.createAxon();
        },
        
       createHexagonalSoma: function() {
  // Create hexagonal prism for soma
  const soma = document.createElement('a-cylinder');
  soma.setAttribute('segments-radial', '6');
  soma.setAttribute('height', '0.3');
  soma.setAttribute('radius', '0.4');
  soma.setAttribute('color', '#ffdd88');
  soma.setAttribute('material', {
    roughness: 0.8,
    metalness: 0.2,
    opacity: 0.9
  });
  soma.setAttribute('rotation', '90 30 0');
  soma.setAttribute('animation', {
    property: 'scale',
    dir: 'alternate',
    dur: 2000,
    loop: true,
    to: '1.05 1.05 1.05'
  });
  
  // Inner nucleus (hexagonal)
  const nucleus = document.createElement('a-cylinder');
  nucleus.setAttribute('segments-radial', '6');
  nucleus.setAttribute('height', '0.2');
  nucleus.setAttribute('radius', '0.2');
  nucleus.setAttribute('color', '#ffcccc');
  nucleus.setAttribute('rotation', '90 30 0');
  nucleus.setAttribute('animation', {
    property: 'scale',
    dir: 'alternate',
    dur: 2000,
    loop: true,
    to: '1.05 1.05 1.05'
  });
  
  this.el.appendChild(soma);
  this.el.appendChild(nucleus);
},
              
       createDendrites: function() {
  // Create fewer, more distinct dendrites
  for (let i = 0; i < 6; i++) {
    const angle = (Math.PI * 2 * i) / 6;
    // Make dendrites extend more upward
    const yBias = 0.3; // Bias for upward growth
    
    const dendrite = document.createElement('a-entity');
    const end = {
      x: Math.cos(angle) * 0.6,
      y: Math.sin(angle) * 0.6 + yBias,
      z: 0
    };
    
    dendrite.setAttribute('line', {
      start: {x: 0, y: 0, z: 0},
      end: end,
      color: '#ffdd88',
      opacity: 0.9,
      width: 0.03
    });
    
    // Create more organized branching
    this.createOrganizedBranch(end, 2, angle);
    this.el.appendChild(dendrite);
  }
},

createOrganizedBranch: function(start, depth, baseAngle) {
  if (depth <= 0) return;
  
  // Create two branches with controlled angles
  const branchAngles = [-0.5, 0.5];
  branchAngles.forEach(angleOffset => {
    const newAngle = baseAngle + angleOffset;
    const length = 0.4 / (depth + 0.5); // Shorter branches as we go deeper
    
    const end = {
      x: start.x + Math.cos(newAngle) * length,
      y: start.y + Math.sin(newAngle) * length,
      z: start.z
    };
    
    const branch = document.createElement('a-entity');
    branch.setAttribute('line', {
      start: start,
      end: end,
      color: '#ffdd88',
      opacity: 0.9,
      width: 0.02 / depth // Thinner branches as we go deeper
    });
    
    this.el.appendChild(branch);
    this.createOrganizedBranch(end, depth - 1, newAngle);
  });
}
            
            const terminal = document.createElement('a-cylinder');
            terminal.setAttribute('height', '0.15');
            terminal.setAttribute('radius', '0.04');
            terminal.setAttribute('position', `${pos.x} ${pos.y} ${pos.z}`);
            terminal.setAttribute('color', '#ffdd88');
            
            this.el.appendChild(branch);
            this.el.appendChild(terminal);
          });
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-entity id="neuron" multipolar-neuron position="0 0.5 -3" scale="1.5 1.5 1.5"></a-entity>
      
      <a-camera position="0 0 0"></a-camera>
      
      <a-sky color="#001133"></a-sky>
      <a-light type="ambient" intensity="0.5"></a-light>
      <a-light type="directional" position="1 1 1" intensity="0.8"></a-light>
      <a-light type="point" position="-1 1 0" intensity="0.5"></a-light>
    </a-scene>
  </body>
</html>
