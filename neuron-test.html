<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script>
      AFRAME.registerComponent('multipolar-neuron', {
        init: function() {
          this.createSoma();
          this.createDendrites();
          this.createAxon();
        },
        
        createSoma: function() {
          const soma = document.createElement('a-sphere');
          soma.setAttribute('radius', '0.4');
          soma.setAttribute('color', '#88ccff');
          soma.setAttribute('material', 'roughness: 0.8; metalness: 0.2');
          soma.setAttribute('animation', 'property: scale; to: 1.05 1.05 1.05; dir: alternate; dur: 2000; loop: true');
          this.el.appendChild(soma);
        },
        
        createDendrites: function() {
          for (let i = 0; i < 30; i++) {
            const dendrite = document.createElement('a-entity');
            const end = {
              x: (Math.random() - 0.5) * 2,
              y: (Math.random() - 0.5) * 2,
              z: (Math.random() - 0.5) * 2
            };
            // Avoid creating dendrites in the bottom quadrant
            if (end.y < -0.3) continue;
            
            dendrite.setAttribute('line', {
              start: {x: 0, y: 0, z: 0},
              end: end,
              color: '#66aadd',
              opacity: 0.75,
              width: 0.01
            });
            
            const synapse = document.createElement('a-sphere');
            synapse.setAttribute('radius', '0.02');
            synapse.setAttribute('position', `${end.x} ${end.y} ${end.z}`);
            synapse.setAttribute('color', '#4488cc');
            
            this.el.appendChild(dendrite);
            this.el.appendChild(synapse);
          }
        },
        
        createAxon: function() {
          // Main axon trunk
          const axon = document.createElement('a-cylinder');
          axon.setAttribute('height', '2');
          axon.setAttribute('radius', '0.05');
          axon.setAttribute('position', '0 -1 0');
          axon.setAttribute('rotation', '90 0 0');
          axon.setAttribute('color', '#5599cc');
          
          // Axon terminals
          for (let i = 0; i < 8; i++) {
            const terminal = document.createElement('a-entity');
            const pos = {
              x: (Math.random() - 0.5) * 0.8,
              y: -2 - Math.random() * 0.3,
              z: (Math.random() - 0.5) * 0.8
            };
            
            // Terminal branch
            const branch = document.createElement('a-cylinder');
            branch.setAttribute('height', '0.3');
            branch.setAttribute('radius', '0.03');
            branch.setAttribute('position', `${pos.x} ${pos.y} ${pos.z}`);
            branch.setAttribute('color', '#5599cc');
            
            // Terminal button
            const button = document.createElement('a-sphere');
            button.setAttribute('radius', '0.06');
            button.setAttribute('position', `${pos.x} ${pos.y - 0.2} ${pos.z}`);
            button.setAttribute('color', '#3377aa');
            button.setAttribute('animation', 'property: scale; to: 1.2 1.2 1.2; dir: alternate; dur: 1500; loop: true');
            
            this.el.appendChild(branch);
            this.el.appendChild(button);
          }
          
          this.el.appendChild(axon);
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-entity id="multipolar-neuron" multipolar-neuron position="0 0 -3" scale="1.5 1.5 1.5"></a-entity>
      
      <a-camera position="0 0 0"></a-camera>
      
      <a-sky color="#001133"></a-sky>
      <a-light type="ambient" intensity="0.5"></a-light>
      <a-light type="directional" position="1 1 1" intensity="0.8"></a-light>
    </a-scene>
  </body>
</html>
